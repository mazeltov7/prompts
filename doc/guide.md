# 1. プロンプトの書き方の基礎

## 1.1 標準的なプロンプトの構成

プロンプト自体は様々な書き方ができますが、大まかに下記の構成になっていることが多いです。

・命令（Instructions）
・文脈（Context）
・入力データ（Input Data）
・出力指標（Output indicator）

例 1：

```jsx
次の文章を、ネガティブ・中立・ポジティブ、に分類してください　[命令]
文章：この食べ物は美味しい。　　                        [入力データ]
感情：　　　　　　　　　　                        　　　[出力指標]
```

例 2：

```jsx
# 命令書：
あなたは、`経験豊富な料理人`です。
以下の制約条件と入力文をもとに、`おいしいレシピ`を提案してください。

# 制約条件:
`
・調理時間は30分以内
・材料は5つ以下
・栄養バランスを考慮
・手順をシンプルに
`

# 入力文：
`<ここに入力文章>`

# 出力文：
```

## 1.2 一般的なプロンプトタスク

一般的なプロンプトのタスクとして、「要約」、「質問への回答」、「テキスト分類」、「ロールプレイ」、「コード生成」、「推論」などがあります。

例とともに、一つずつ見ていきます。

### 「要約」

```jsx
下記の文章を1行で説明してください。

ChatGPTは、OpenAIが開発した大規模な人工知能言語モデルで、GPT-4アーキテクチャをベースにしています。
GPTは「Generative Pre-trained Transformer」の略で、これは自然言語処理 (NLP) のタスクにおいて高い性能を発揮するモデルです。
ChatGPTは、質問応答、文章生成、文章の要約、機械翻訳など、さまざまなタスクをこなすことができます。
ChatGPTは、ウェブ上で利用可能なアプリケーションとして提供されており、多くの人々が会話型のインターフェイスを通じて情報検索や質問応答などの用途で利用しています。
モデルは大量のテキストデータをもとに学習し、その過程で幅広い知識を獲得しています。ただし、知識の更新が2021年9月までのものであるため、それ以降の出来事や情報については把握していません。
ChatGPTの性能は、最先端の自然言語処理技術によって支えられています。
しかし、完璧な知識や理解力を持っているわけではなく、時に誤った情報や不正確な回答を提供することがあります。
また、モデルのバイアスや人間の倫理観に基づく問題に対処するために、OpenAIは継続的にモデルの改善と研究を行っています。

```

response

```jsx
ChatGPTは、OpenAIが開発したGPT-4ベースのAI言語モデルで、
自然言語処理タスクに高い性能を発揮し、ウェブアプリケーションとして提供されており、
最先端技術による多様なタスク対応が可能ですが、完璧ではなく、
継続的に改善と研究が行われています。
```

### 「質問への回答」

```jsx
下記の質問に簡潔に回答してください。
答えがわからない場合は、「わからない」と返答してください。

Context：量子コンピュータは、量子ビット（qubit）を使用して情報を処理し、従来のコンピュータよりもはるかに高速で複雑な計算を行うことができます。
量子ビットは、0と1の両方の状態を同時に保持することができるため、計算能力が指数関数的に向上します。
ただし、量子コンピュータは、量子デコヒーレンスという現象によって、情報が失われることがあります。

Question：量子デコヒーレンスが量子コンピュータの性能にどのような影響を与えるか説明してください。

Answer：
```

response

```jsx
量子デコヒーレンスは、量子ビットが外部環境と相互作用することで、
その状態が不確かになり、量子ビットが古典的なビットのように振る舞い始める現象です。
このため、量子コンピュータの性能に悪影響を与え、計算の正確性が低下したり、
計算速度が遅くなったりすることがあります。デコヒーレンスを最小限に抑えることは、
量子コンピュータの信頼性と性能向上のための重要な課題です。
```

### 「テキスト分類」

```jsx
次の文章を、ネガティブ・中立・ポジティブ、に分類してください
文章：この食べ物は美味しい。
感情：
```

response

```jsx
感情：ポジティブ
```

### 「ロールプレイ」

```jsx
あなたには詩人として振る舞ってほしいです。
感情を引き起こし、人々の魂を揺り動かす力を持つ詩を作成してください。
どんなトピックやテーマでも書いて構いませんが、美しくかつ意味のある方法で表現しようとしている感情を伝える言葉を選んでください。
また、読者の心に深い印象を残すほどに力強い短い詩を考えることもできます。

テーマ：お腹が空いてきました。
```

response

```jsx
空腹の夜、月の微笑み
鳴り響く夢、踊る食欲
喜びの宴、腹の奥へ

香り漂う、夜風の中
料理の魔法、舌の旅路
飢える心、ため息まじり

味わい深い、想いの糸
絡み合う時間、繋ぐ絆
シェフの手、愛情と創造

満ちる腹、幸せの共鳴
感謝の歌、世界を満たす
営みの中、命の輪廻
```

### 「コード生成」

```jsx
Table teams, columns = [TeamId, TeamName]
Table members, columns = [TeamId, MemberId, MemberName]

エンジニアチームのメンバー全員を選ぶための、MySQLクエリをつくって

```

response

```jsx
SELECT members.MemberId, members.MemberName
FROM members
JOIN teams ON members.TeamId = teams.TeamId
WHERE teams.TeamName = 'Engineers';
```

### 「推論」

```jsx
下記の問題を解いてください。step by stepで順を追って解いてください。

問題：あなたは駅から図書館まで歩いて行くことにしました。
以下の指示に従って、最終的な方向を特定してください。

駅を出て、北に3ブロック進みます。
次に、東に2ブロック進みます。
南に1ブロック進みます。
最後に、西に4ブロック進みます。
あなたは最終的にどの方向にいますか？
```

response

```jsx
1. 最初に北に3ブロック進むと、あなたは北に3ブロック離れた位置にいます。
2. 次に、東に2ブロック進むと、あなたは北に3ブロック、東に2ブロック離れた位置にいます。
3. 南に1ブロック進むと、あなたは北に2ブロック、東に2ブロック離れた位置にいます。
4. 最後に、西に4ブロック進むと、あなたは北に2ブロック、西に2ブロック離れた位置にいます。
最終的な方向は、北に2ブロック、西に2ブロック離れた位置にいます。
```

# 2. 高度なプロンプト技術

プロンプトを作る上で、知っておくと、良い回答を導ける手法がいくつかあるので簡単にご紹介します。

## 2.1 Few-shot prompts

プロンプトの中に、いつかのサンプルを入れることで、推論の精度を高める手法。

```jsx
フランスの首都はどこですか？
日本の首都は、東京です。
アメリカの首都は、ワシントンD.Cです。
```

response

```jsx
フランスの首都はパリです。
```

## 2.2 Chain-of-Thought (CoT) Prompting

プロンプトの中に、解決すべき課題を考える上で、参考になる思考の型を記載しておきます。思考の連鎖を意識させることで、回答の精度を上げる手法です。

```jsx
ある池に鶴と亀がいます。
鶴と亀の合計で7匹がいて、足の数が合計で20本です。
鶴と亀はそれぞれ何匹ずついますか？
答え：鶴は4匹で、亀は3匹です。

次の問いに答えてください。
鶴と亀を合計すると5匹で、足の数を合計すると14本である。
その場合、亀は何匹いるか？
```

response

```jsx
問題を解決するために、まず2つの方程式を立てます。

鶴の数をT、亀の数をKとし、合計は5匹です。この方程式は T + K = 5 です。
鶴の足が2本であり、亀の足が4本であることを考慮し、足の合計が14本であるとします。この方程式は 2T + 4K = 14 です。
次に、この連立方程式を解きます。

Step 1:
T + K = 5 から T = 5 - K を得ます。

Step 2:
Tの式を2番目の方程式に代入します。
2(5 - K) + 4K = 14

Step 3:
式を展開し、Kについて解きます。
10 - 2K + 4K = 14
2K = 4
K = 2

従って、亀は2匹います。
```

## 2.3 Zero-shot CoT(Chain-of-Thought)

Chain-of-Thought (CoT) Prompting と違って、参考になる思考の型は記載せず、代わりに「step by step で考えましょう」「順を追って回答してください」などを付記して、順序立てて考えさせることで回答の精度を上げる手法です。

```jsx
次の問いに答えてください。
鶴と亀を合計すると5匹で、足の数を合計すると14本である。
その場合、亀は何匹いるか？

回答は、step by stepで順を追って回答してください。
```

response

```jsx
問題を解決するために、まず2つの方程式を立てます。

鶴の数をT、亀の数をKとし、合計は5匹です。この方程式は T + K = 5 です。
鶴の足が2本であり、亀の足が4本であることを考慮し、足の合計が14本であるとします。この方程式は 2T + 4K = 14 です。
次に、この連立方程式を解きます。

Step 1:
T + K = 5 から T = 5 - K を得ます。

Step 2:
Tの式を2番目の方程式に代入します。
2(5 - K) + 4K = 14

Step 3:
式を展開し、Kについて解きます。
10 - 2K + 4K = 14
2K = 4
K = 2

従って、亀は2匹います。
```

## 2.4 ReAct (Reasoning and Acting)

推論と"アクション"を組み合わせて、順を追って考えることで、質問応答や論理的な推論タスクの解決の精度を上げる手法です。

- [ReAct: Synergizing Reasoning and Acting in Language Models](https://arxiv.org/abs/2210.03629)
  外部 API でデータを検索したり、計算した結果をプロンプトに反映したりして、正確性を上げる。

# 3. その他知っておくと便利な Tips
